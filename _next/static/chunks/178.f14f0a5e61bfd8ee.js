"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{3116:(e,t,r)=>{r.d(t,{B2:()=>c,n0:()=>s,tG:()=>a,yV:()=>l});let n="viewedConversations";function s(e){try{let t=o();t.includes(e)||(t.push(e),localStorage.setItem(n,JSON.stringify(t)))}catch(e){console.error("Error marking conversation as viewed:",e)}}function l(e){try{return o().includes(e)}catch(e){return console.error("Error checking if conversation is viewed:",e),!1}}function o(){try{let e=localStorage.getItem(n);return e?JSON.parse(e):[]}catch(e){return console.error("Error getting viewed conversations:",e),[]}}function a(){try{localStorage.removeItem(n)}catch(e){console.error("Error resetting viewed conversations:",e)}}function c(e,t){try{let r=o(),s=t.filter(t=>t.character1===e||t.character2===e).map(e=>e.conversation_id),l=r.filter(e=>!s.includes(e));localStorage.setItem(n,JSON.stringify(l))}catch(e){console.error("Error resetting character viewed conversations:",e)}}},6046:(e,t,r)=>{var n=r(6658);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},6178:(e,t,r)=>{r.r(t),r.d(t,{default:()=>L});var n=r(5155),s=r(8803),l=r.n(s),o=r(2115),a=r(9232),c=r(9895),i=r(6895),d=r(4874),u=r(4957),h=r(5565),m=r(71);let g=e=>{let{voiceLines:t,selectedCategory:r,currentPlayingFile:s=null,onVoiceLinePlayed:l=()=>{},onVoiceLinePaused:a=()=>{},expandAll:c=!1,characterName:i,isPlayingAll:g=!1,currentPlayingCharacter:x=null,currentPlayingCategory:f=null,onPlayCharacter:b=()=>{},onPlayCategory:v=()=>{}}=e,[p,y]=(0,o.useState)(new Set),[j,w]=(0,o.useState)({}),[N,S]=(0,o.useState)(!1),k={},E={};Object.entries(t).forEach(e=>{let[t,r]=e;"self"===t.toLowerCase()?k[t]=r:E[t]=r});let L={},C={};Object.entries(k).forEach(e=>{let[t,n]=e;r?n[r]&&(L[t]={[r]:n[r]}):L[t]=n}),Object.entries(E).forEach(e=>{let[t,n]=e;r?n[r]&&(C[t]={[r]:n[r]}):C[t]=n});let O={...L,...C};if((0,o.useEffect)(()=>{console.log("VoiceLinesAbout - voiceLines keys:",Object.keys(t)),console.log("VoiceLinesAbout - selfVoiceLines keys:",Object.keys(k)),console.log("VoiceLinesAbout - otherVoiceLines keys:",Object.keys(E)),console.log("VoiceLinesAbout - filteredSelfVoiceLines keys:",Object.keys(L)),console.log("VoiceLinesAbout - filteredOtherVoiceLines keys:",Object.keys(C))},[t,k,E,L,C]),(0,o.useEffect)(()=>{if(c&&!N){y(new Set(Object.keys(O)));let e={};Object.entries(O).forEach(t=>{let[r,n]=t,s=new Set;Object.keys(n).forEach(e=>{s.add(e)}),e[r]=s}),w(e),S(!0)}},[c,N,O]),(0,o.useEffect)(()=>{x&&(y(e=>new Set([...e,x])),f?w(e=>{let t={...e};return t[x]||(t[x]=new Set),t[x]=new Set([...Array.from(t[x]||[]),f]),t}):O[x]&&w(e=>{let t={...e},r=new Set;return Object.keys(O[x]).forEach(e=>{r.add(e)}),t[x]=r,t}))},[x,f]),r&&0===Object.keys(O).length)return(0,n.jsxs)("div",{className:"text-center py-8 text-gray-400",children:['No voice lines found in the "',r,'" category.']});let A=e=>{let t=new Set(p);t.has(e)?t.delete(e):t.add(e),y(t),S(t.size===Object.keys(O).length)},V=(e,t)=>{let r={...j};r[e]||(r[e]=new Set);let n=new Set(r[e]);n.has(t)?n.delete(t):n.add(t),r[e]=n,w(r)},I=e=>{l(e)},P=e=>{a(e)},F=e=>{b(e)},_=(e,t)=>{v(e,t)},J=e=>{var t;if(!O[e]||!j[e])return!1;let r=Object.keys(O[e]).length,n=(null===(t=j[e])||void 0===t?void 0:t.size)||0;return r>0&&n===r},M=e=>{J(e)?(w(t=>{let r={...t};return r[e]=new Set,r}),y(t=>{let r=new Set(t);return r.delete(e),r})):(y(t=>new Set([...t,e])),w(t=>{let r={...t},n=new Set;return O[e]&&Object.keys(O[e]).forEach(e=>{n.add(e)}),r[e]=n,r}))},R=e=>{let t=(0,m.h)(e);return"/minimapIcons/".concat(t,"_mm_psd.png")},z=(e,t)=>(0,n.jsxs)("div",{className:"border rounded-lg p-4 mb-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("button",{className:"text-left font-medium text-lg flex items-center",onClick:()=>A(e),children:["self"!==e.toLowerCase()&&(0,n.jsx)("div",{className:"relative w-6 h-6 mr-2",children:(0,n.jsx)(h.default,{src:R(e),alt:"".concat((0,u.v)(e)," portrait"),fill:!0,sizes:"24px",className:"object-cover rounded-full",onError:e=>{e.target.src="/minimapIcons/genericperson_mm_psd.png"}})}),(0,n.jsx)("span",{children:e}),(0,n.jsx)("span",{className:"ml-2",children:p.has(e)?"−":"+"})]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:()=>M(e),className:"px-3 py-1 rounded text-white text-sm bg-gray-600 hover:bg-gray-700",children:J(e)?"Collapse All":"Expand All"}),(0,n.jsx)("button",{onClick:()=>F(e),className:"px-3 py-1 rounded text-white text-sm ".concat(g&&x===e&&!f?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"),children:g&&x===e&&!f?"Stop Playing":"Play All"})]})]}),p.has(e)&&(0,n.jsx)("div",{className:"mt-4 space-y-4 overflow-y-auto max-h-[500px] custom-scrollbar pr-2",children:Object.entries(t).map(t=>{var r,l;let[o,a]=t;return(0,n.jsxs)("div",{className:"ml-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("button",{className:"text-left font-medium flex items-center",onClick:()=>V(e,o),children:[(0,n.jsx)("span",{children:o}),(0,n.jsx)("span",{className:"ml-2",children:(null===(r=j[e])||void 0===r?void 0:r.has(o))?"−":"+"})]}),(0,n.jsx)("button",{onClick:()=>_(e,o),className:"px-3 py-1 rounded text-white text-xs ".concat(g&&x===e&&f===o?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"),children:g&&x===e&&f===o?"Stop":"Play"})]}),(null===(l=j[e])||void 0===l?void 0:l.has(o))&&(0,n.jsx)("div",{className:"mt-2 space-y-2 pr-2",children:Array.isArray(a)?a.map(e=>(0,n.jsx)(d.A,{filename:e.filename,transcription:e.transcription,externalIsPlaying:s===e.filename,onPlay:I,onPause:P},e.voiceline_id)):Object.entries(a).map(e=>{let[t,r]=e;return(0,n.jsxs)("div",{className:"ml-4",children:[(0,n.jsx)("h4",{className:"font-medium",children:t}),(0,n.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,n.jsx)(d.A,{filename:e.filename,transcription:e.transcription,externalIsPlaying:s===e.filename,onPlay:I,onPause:P},e.voiceline_id))})]},t)})})]},o)})})]},e);return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsxs)("h2",{className:"text-lg font-semibold text-white",children:["Voice Lines Spoken By ",(0,u.v)(i)]}),(0,n.jsx)("button",{onClick:()=>{if(N)y(new Set),w({}),S(!1);else{y(new Set(Object.keys(O)));let e={};Object.entries(O).forEach(t=>{let[r,n]=t,s=new Set;Object.keys(n).forEach(e=>{s.add(e)}),e[r]=s}),w(e),S(!0)}},className:"px-3 py-1 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700",children:N?"Collapse All":"Expand All"})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[Object.keys(L).length>0&&(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold text-blue-400 mb-4",children:"Voice Lines About Self"}),Object.entries(L).map(e=>{let[t,r]=e;return z(t,r)})]}),Object.keys(C).length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-xl font-semibold text-blue-400 mb-4",children:"Voice Lines About Others"}),Object.entries(C).map(e=>{let[t,r]=e;return z(t,r)})]}),0===Object.keys(O).length&&(0,n.jsxs)("div",{className:"text-center py-8 text-gray-400",children:["No voice lines found for ",(0,u.v)(i),r?' in the "'.concat(r,'" category'):""]})]})]})},x=e=>{let{voiceLines:t,characterName:r,selectedCategory:s,currentPlayingFile:l=null,onVoiceLinePlayed:a=()=>{},onVoiceLinePaused:c=()=>{},expandAll:i=!1,isPlayingAll:g=!1,currentPlayingCharacter:x=null,currentPlayingCategory:f=null,onPlayCharacter:b=()=>{},onPlayCategory:v=()=>{}}=e,[p,y]=(0,o.useState)(new Set),[j,w]=(0,o.useState)({}),[N,S]=(0,o.useState)(!1);if(0===Object.keys(t).length)return(0,n.jsxs)("div",{className:"text-center py-8 text-gray-400",children:["No voice lines about ",(0,u.v)(r)," from other characters."]});let k={};if(Object.entries(t).forEach(e=>{let[t,r]=e;s?r[s]&&(k[t]={[s]:r[s]}):k[t]=r}),s&&0===Object.keys(k).length)return(0,n.jsxs)("div",{className:"text-center py-8 text-gray-400",children:['No voice lines found in the "',s,'" category.']});(0,o.useEffect)(()=>{if(i&&!N){y(new Set(Object.keys(k)));let e={};Object.entries(k).forEach(t=>{let[r,n]=t,s=new Set;Object.keys(n).forEach(e=>{s.add(e)}),e[r]=s}),w(e),S(!0)}},[i,N,k]),(0,o.useEffect)(()=>{x&&(y(e=>new Set([...e,x])),f?w(e=>{let t={...e};return t[x]||(t[x]=new Set),t[x]=new Set([...Array.from(t[x]||[]),f]),t}):k[x]&&w(e=>{let t={...e},r=new Set;return Object.keys(k[x]).forEach(e=>{r.add(e)}),t[x]=r,t}))},[x,f]);let E=e=>{let t=new Set(p);t.has(e)?t.delete(e):t.add(e),y(t),S(t.size===Object.keys(k).length)},L=(e,t)=>{let r={...j};r[e]||(r[e]=new Set);let n=new Set(r[e]);n.has(t)?n.delete(t):n.add(t),r[e]=n,w(r)},C=e=>{a(e)},O=e=>{c(e)},A=e=>{b(e)},V=(e,t)=>{v(e,t)},I=e=>{var t;if(!k[e]||!j[e])return!1;let r=Object.keys(k[e]).length,n=(null===(t=j[e])||void 0===t?void 0:t.size)||0;return r>0&&n===r},P=e=>{I(e)?(w(t=>{let r={...t};return r[e]=new Set,r}),y(t=>{let r=new Set(t);return r.delete(e),r})):(y(t=>new Set([...t,e])),w(t=>{let r={...t},n=new Set;return k[e]&&Object.keys(k[e]).forEach(e=>{n.add(e)}),r[e]=n,r}))},F=e=>{let t=(0,m.h)(e);return"/minimapIcons/".concat(t,"_mm_psd.png")};return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsxs)("h2",{className:"text-lg font-semibold text-white",children:["Lines About ",(0,u.v)(r)]}),(0,n.jsx)("button",{onClick:()=>{if(N)y(new Set),w({}),S(!1);else{y(new Set(Object.keys(k)));let e={};Object.entries(k).forEach(t=>{let[r,n]=t,s=new Set;Object.keys(n).forEach(e=>{s.add(e)}),e[r]=s}),w(e),S(!0)}},className:"px-3 py-1 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700",children:N?"Collapse All":"Expand All"})]}),(0,n.jsx)("div",{className:"space-y-4",children:Object.entries(k).map(e=>{let[t,r]=e;return(0,n.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("button",{className:"text-left font-medium text-lg flex items-center",onClick:()=>E(t),children:[(0,n.jsx)("div",{className:"relative w-6 h-6 mr-2",children:(0,n.jsx)(h.default,{src:F(t),alt:"".concat((0,u.v)(t)," portrait"),fill:!0,sizes:"24px",className:"object-cover rounded-full",onError:e=>{e.target.src="/minimapIcons/genericperson_mm_psd.png"}})}),(0,n.jsx)("span",{children:t}),(0,n.jsx)("span",{className:"ml-2",children:p.has(t)?"−":"+"})]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:()=>P(t),className:"px-3 py-1 rounded text-white text-sm bg-gray-600 hover:bg-gray-700",children:I(t)?"Collapse All":"Expand All"}),(0,n.jsx)("button",{onClick:()=>A(t),className:"px-3 py-1 rounded text-white text-sm ".concat(g&&x===t&&!f?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"),children:g&&x===t&&!f?"Stop Playing":"Play All"})]})]}),p.has(t)&&(0,n.jsx)("div",{className:"mt-4 space-y-4 overflow-y-auto max-h-[500px] custom-scrollbar pr-2",children:Object.entries(r).map(e=>{var r,s;let[o,a]=e;return(0,n.jsxs)("div",{className:"ml-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("button",{className:"text-left font-medium flex items-center",onClick:()=>L(t,o),children:[(0,n.jsx)("span",{children:o}),(0,n.jsx)("span",{className:"ml-2",children:(null===(r=j[t])||void 0===r?void 0:r.has(o))?"−":"+"})]}),(0,n.jsx)("button",{onClick:()=>V(t,o),className:"px-3 py-1 rounded text-white text-xs ".concat(g&&x===t&&f===o?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"),children:g&&x===t&&f===o?"Stop":"Play"})]}),(null===(s=j[t])||void 0===s?void 0:s.has(o))&&(0,n.jsx)("div",{className:"mt-2 space-y-2 pr-2",children:Array.isArray(a)?a.map(e=>(0,n.jsx)(d.A,{filename:e.filename,transcription:e.transcription,externalIsPlaying:l===e.filename,onPlay:C,onPause:O},e.voiceline_id)):Object.entries(a).map(e=>{let[t,r]=e;return(0,n.jsxs)("div",{className:"ml-4",children:[(0,n.jsx)("h4",{className:"font-medium",children:t}),(0,n.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,n.jsx)(d.A,{filename:e.filename,transcription:e.transcription,externalIsPlaying:l===e.filename,onPlay:C,onPause:O},e.voiceline_id))})]},t)})})]},o)})})]},t)})})]})},f=e=>{let{characterName:t}=e,{voiceLines:r,loading:s,error:l}=(0,c.E)(),[a,d]=(0,o.useState)("about"),[h,m]=(0,o.useState)([]),[f,b]=(0,o.useState)(!1),[v,p]=(0,o.useState)([]),[y,j]=(0,o.useState)(null),[w,N]=(0,o.useState)(null),S=(0,o.useRef)(null),k=(0,o.useRef)(0),E=(0,o.useRef)([]),[L,C]=(0,o.useState)(null),[O,A]=(0,o.useState)(!1),V=(0,o.useRef)(v),I=(0,o.useRef)(h),P=(0,o.useRef)(f);if((0,o.useEffect)(()=>()=>{console.log("VoiceLinesSection - Cleaning up audio resources"),S.current&&(S.current.pause(),S.current.src="",S.current=null),P.current=!1,b(!1),C(null)},[]),(0,o.useEffect)(()=>{console.log("VoiceLinesSection - voiceLines data:",r?"available":"not available"),r&&console.log("VoiceLinesSection - voiceLines keys:",Object.keys(r))},[r]),(0,o.useEffect)(()=>{V.current=v},[v]),(0,o.useEffect)(()=>{I.current=h},[h]),(0,o.useEffect)(()=>{P.current=f,console.log("isPlayingAll state changed to:",f)},[f]),(0,o.useEffect)(()=>{{let e=()=>{console.log("VoiceLinesSection - Loading filters from session storage");let e=sessionStorage.getItem("voiceLineFilterTab");e&&(console.log("VoiceLinesSection - Loading saved tab:",e),d(e));let t=sessionStorage.getItem("voiceLineFilterCharacters");if(t)try{let e=JSON.parse(t);Array.isArray(e)&&(console.log("VoiceLinesSection - Loading saved characters:",e),JSON.stringify(e)!==JSON.stringify(V.current)&&p(e))}catch(e){console.error("Error parsing saved voice line filter characters:",e),V.current.length>0&&p([])}else V.current.length>0&&p([]);let r=sessionStorage.getItem("voiceLineFilterCategories");if(r)try{let e=JSON.parse(r);Array.isArray(e)&&(console.log("VoiceLinesSection - Loading saved categories:",e),JSON.stringify(e)!==JSON.stringify(I.current)&&m(e))}catch(e){console.error("Error parsing saved voice line filter categories:",e),I.current.length>0&&m([])}else I.current.length>0&&m([])};e();let t=()=>{console.log("VoiceLinesSection - Filter change detected"),setTimeout(e,0)};return window.addEventListener("voiceLineFilterChange",t),()=>{window.removeEventListener("voiceLineFilterChange",t)}}},[]),s)return(0,n.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"}),(0,n.jsx)("span",{className:"ml-3 text-gray-400",children:"Loading voice lines..."})]});if(l)return(0,n.jsxs)("div",{className:"bg-red-900/30 border border-red-700 rounded-lg p-6 text-center",children:[(0,n.jsx)("p",{className:"text-red-400 mb-2",children:"Error loading voice lines"}),(0,n.jsx)("p",{className:"text-gray-400 text-sm",children:l})]});if(!r||0===Object.keys(r).length)return(0,n.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 text-center",children:[(0,n.jsx)("p",{className:"text-gray-400 mb-2",children:"No voice lines data available"}),(0,n.jsx)("p",{className:"text-gray-500 text-sm",children:"Voice lines may still be loading or there might be an issue with the data source."}),(0,n.jsxs)("div",{className:"mt-4 p-4 bg-gray-900 rounded text-left text-xs text-gray-400 overflow-auto max-h-60",children:[(0,n.jsxs)("p",{children:["Character name: ",t]}),(0,n.jsxs)("p",{children:["Voice lines data available: ",r?"Yes":"No"]}),(0,n.jsxs)("p",{children:["Voice lines keys: ",r?Object.keys(r).join(", "):"None"]}),(0,n.jsxs)("p",{children:["Selected characters: ",v.join(", ")||"None"]}),(0,n.jsxs)("p",{children:["Selected categories: ",h.join(", ")||"None"]})]})]});let F=(0,i.Kg)(r,t),_=(0,i.qJ)(r,t),J=(0,o.useMemo)(()=>{if(console.log("VoiceLinesSection - Filtering voice lines about with characters:",v),!r||0===Object.keys(r).length||!F||0===Object.keys(F).length)return console.log("VoiceLinesSection - No voice lines data available for filtering"),{};let e={},t=v.length>0?v:Object.keys(F);return console.log("VoiceLinesSection - Characters to include:",t),t.forEach(t=>{F[t]&&(e[t]=F[t])}),console.log("VoiceLinesSection - Filtered voice lines about result keys:",Object.keys(e)),e},[F,v,r]),M=(0,o.useMemo)(()=>{if(console.log("VoiceLinesSection - Filtering voice lines by with characters:",v),!r||0===Object.keys(r).length||!_||0===Object.keys(_).length)return console.log("VoiceLinesSection - No voice lines data available for filtering"),{};let e={},t=v.length>0?v:Object.keys(_);return console.log("VoiceLinesSection - Characters to include:",t),t.forEach(t=>{_[t]&&(e[t]=_[t])}),console.log("VoiceLinesSection - Filtered voice lines by result keys:",Object.keys(e)),e},[_,v,r]),R=(e,t)=>{let r=[];console.log('Extracting audio files for character "'.concat(e,'" from ').concat(t," tab..."));try{if("about"===t&&J[e]){let t=J[e];Object.entries(t).forEach(e=>{let[t,n]=e;(0===h.length||h.includes(t))&&(console.log("Processing category: ".concat(t)),Array.isArray(n)?n.forEach(e=>{e&&e.filename&&r.push(e.filename)}):"object"==typeof n&&null!==n&&("filename"in n&&"string"==typeof n.filename?r.push(n.filename):Object.entries(n).forEach(e=>{let[t,n]=e;Array.isArray(n)?n.forEach(e=>{e&&e.filename&&r.push(e.filename)}):"object"==typeof n&&null!==n&&"filename"in n&&r.push(n.filename)})))})}else if("by"===t&&M[e]){let t=M[e];Object.entries(t).forEach(e=>{let[t,n]=e;(0===h.length||h.includes(t))&&(console.log("Processing category: ".concat(t)),Array.isArray(n)?n.forEach(e=>{e&&e.filename&&r.push(e.filename)}):"object"==typeof n&&null!==n&&("filename"in n&&"string"==typeof n.filename?r.push(n.filename):Object.entries(n).forEach(e=>{let[t,n]=e;Array.isArray(n)?n.forEach(e=>{e&&e.filename&&r.push(e.filename)}):"object"==typeof n&&null!==n&&"filename"in n&&r.push(n.filename)})))})}if(console.log("Extracted ".concat(r.length,' audio files for character "').concat(e,'"')),r.length>0){let e=Math.min(5,r.length);console.log("First ".concat(e," files in playlist:"),r.slice(0,e))}}catch(t){console.error('Error extracting audio files for character "'.concat(e,'":'),t)}return r},z=(e,t,r)=>{let n=[];console.log('Extracting audio files for character "'.concat(e,'" and category "').concat(t,'" from ').concat(r," tab..."));try{if("about"===r&&J[e]){let r=J[e];if(r[t]){let e=r[t];Array.isArray(e)?e.forEach(e=>{e&&e.filename&&n.push(e.filename)}):"object"==typeof e&&null!==e&&("filename"in e&&"string"==typeof e.filename?n.push(e.filename):Object.entries(e).forEach(e=>{let[t,r]=e;Array.isArray(r)?r.forEach(e=>{e&&e.filename&&n.push(e.filename)}):"object"==typeof r&&null!==r&&"filename"in r&&n.push(r.filename)}))}}else if("by"===r&&M[e]){let r=M[e];if(r[t]){let e=r[t];Array.isArray(e)?e.forEach(e=>{e&&e.filename&&n.push(e.filename)}):"object"==typeof e&&null!==e&&("filename"in e&&"string"==typeof e.filename?n.push(e.filename):Object.entries(e).forEach(e=>{let[t,r]=e;Array.isArray(r)?r.forEach(e=>{e&&e.filename&&n.push(e.filename)}):"object"==typeof r&&null!==r&&"filename"in r&&n.push(r.filename)}))}}if(console.log("Extracted ".concat(n.length,' audio files for character "').concat(e,'" and category "').concat(t,'"')),n.length>0){let e=Math.min(5,n.length);console.log("First ".concat(e," files in playlist:"),n.slice(0,e))}}catch(r){console.error('Error extracting audio files for character "'.concat(e,'" and category "').concat(t,'":'),r)}return n},T=(e,t,r)=>{try{if(P.current){console.log("Stopping playback of voice lines"),P.current=!1,b(!1),j(null),N(null),S.current&&(S.current.pause(),S.current.src="",S.current.onended=null,S.current.onerror=null),C(null);return}console.log('Extracting audio files for character "'.concat(e,'" and category "').concat(t,'"...'));let n=z(e,t,r);if(0===n.length){console.warn('No audio files found for character "'.concat(e,'" and category "').concat(t,'"')),alert("No voice lines found for ".concat(e," in the ").concat(t," category."));return}console.log("Starting playback of ".concat(n.length,' voice lines for character "').concat(e,'" and category "').concat(t,'"')),j(e),N(t),E.current=n,k.current=0,P.current=!0,b(!0),S.current||(S.current=new Audio),W()}catch(r){console.error('Error in playCategoryVoiceLines for "'.concat(e,'" and category "').concat(t,'":'),r),alert("Error playing voice lines: ".concat(r.message)),P.current=!1,b(!1),j(null),N(null),C(null)}},B=(e,t)=>{try{if(P.current){console.log("Stopping playback of voice lines"),P.current=!1,b(!1),j(null),N(null),S.current&&(S.current.pause(),S.current.src="",S.current.onended=null,S.current.onerror=null),C(null),A(!1);return}console.log('Extracting audio files for character "'.concat(e,'"...'));let r=R(e,t);if(0===r.length){console.warn('No audio files found for character "'.concat(e,'"')),alert("No voice lines found for ".concat(e," with the current filters."));return}console.log("Starting playback of ".concat(r.length,' voice lines for character "').concat(e,'"')),j(e),N(null),E.current=r,k.current=0,P.current=!0,b(!0),S.current||(S.current=new Audio),W()}catch(t){console.error('Error in playCharacterVoiceLines for "'.concat(e,'":'),t),alert("Error playing voice lines: ".concat(t.message)),P.current=!1,b(!1),j(null),N(null),C(null)}},W=()=>{try{if(!P.current||!E.current||0===E.current.length){console.log("Cannot play current audio: playback not active or no audio files");return}let e=E.current[k.current];console.log("Playing voice line (".concat(k.current+1,"/").concat(E.current.length,"): ").concat(e)),S.current||(S.current=new Audio),S.current.onended=null,S.current.onerror=null,S.current.onended=()=>{console.log("Audio ended: ".concat(e)),G()},S.current.onerror=()=>{console.error("Error playing audio ".concat(e)),G()},S.current.src="/audioFiles/".concat(e),C(e);let t=S.current.play();void 0!==t&&t.catch(t=>{console.error("Error playing audio ".concat(e,":"),t),G()})}catch(e){console.error("Error in playCurrentAudio:",e),G()}},G=()=>{try{if(!P.current){console.log("Cannot move to next audio: playback not active");return}if(k.current++,k.current>=E.current.length){console.log("Reached the end of the playlist"),P.current=!1,b(!1),j(null),N(null),C(null);return}W()}catch(e){console.error("Error in moveToNextAudio:",e),P.current=!1,b(!1),j(null),N(null),C(null)}},K=e=>{P.current&&(console.log("Stopping ongoing playback because individual voice line was played"),P.current=!1,b(!1),j(null),N(null),S.current&&(S.current.pause(),S.current.src="",S.current.onended=null,S.current.onerror=null)),C(e)},q=e=>{L===e&&C(null)},D=(0,n.jsxs)("div",{className:"mb-4 p-4 bg-gray-800 rounded text-xs text-gray-400 overflow-auto max-h-60",children:[(0,n.jsxs)("p",{children:["Character name: ",t]}),(0,n.jsxs)("p",{children:["Voice lines about keys: ",Object.keys(F).join(", ")||"None"]}),(0,n.jsxs)("p",{children:["Voice lines by keys: ",Object.keys(_).join(", ")||"None"]}),(0,n.jsxs)("p",{children:["Selected characters: ",v.join(", ")||"None"]}),(0,n.jsxs)("p",{children:["Selected categories: ",h.join(", ")||"None"]}),(0,n.jsxs)("p",{children:["Filtered voice lines about keys: ",Object.keys(J).join(", ")||"None"]}),(0,n.jsxs)("p",{children:["Filtered voice lines by keys: ",Object.keys(M).join(", ")||"None"]})]});return(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsxs)("div",{className:"flex border-b border-gray-700 mb-4",children:[(0,n.jsxs)("button",{className:"px-4 py-2 font-medium ".concat("about"===a?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"),onClick:()=>{d("about"),m([]),sessionStorage.setItem("voiceLineFilterTab","about"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("voiceLineTabChange",{detail:"about"}))},0)},children:["Spoken By ",(0,u.v)(t)]}),(0,n.jsxs)("button",{className:"px-4 py-2 font-medium ".concat("by"===a?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"),onClick:()=>{d("by"),m([]),sessionStorage.setItem("voiceLineFilterTab","by"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("voiceLineTabChange",{detail:"by"}))},0)},children:["Lines About ",(0,u.v)(t)]})]}),(0,n.jsx)("div",{className:"p-4",children:"about"===a?(0,n.jsx)(g,{voiceLines:J,selectedCategory:1===h.length?h[0]:null,currentPlayingFile:L,onVoiceLinePlayed:K,onVoiceLinePaused:q,expandAll:O,characterName:t,isPlayingAll:f,currentPlayingCharacter:y,currentPlayingCategory:w,onPlayCharacter:e=>B(e,"about"),onPlayCategory:(e,t)=>T(e,t,"about")}):(0,n.jsx)(x,{voiceLines:M,characterName:t,selectedCategory:1===h.length?h[0]:null,currentPlayingFile:L,onVoiceLinePlayed:K,onVoiceLinePaused:q,expandAll:O,isPlayingAll:f,currentPlayingCharacter:y,currentPlayingCategory:w,onPlayCharacter:e=>B(e,"by"),onPlayCategory:(e,t)=>T(e,t,"by")})}),D]})};var b=r(8173),v=r.n(b),p=r(6046),y=r(3116),j=r(2030);let w=e=>{let{characterName:t,voiceLines:r}=e,[s,l]=(0,o.useState)("about"),[a,c]=(0,o.useState)([]),[d,u]=(0,o.useState)([]),[h,m]=(0,o.useState)(!1);(0,o.useEffect)(()=>{console.log("VoiceLinesFilter - voiceLines data:",r?"available":"not available"),r&&console.log("VoiceLinesFilter - voiceLines keys:",Object.keys(r))},[r]);let g=(0,o.useMemo)(()=>r&&0!==Object.keys(r).length?(console.log("VoiceLinesFilter - voiceLines data keys:",Object.keys(r||{})),console.log("VoiceLinesFilter - characterName:",t),(0,i.Kg)(r,t)):(console.log("VoiceLinesFilter - No voice lines data available for voiceLinesAbout"),{}),[r,t]),x=(0,o.useMemo)(()=>r&&0!==Object.keys(r).length?(0,i.qJ)(r,t):(console.log("VoiceLinesFilter - No voice lines data available for voiceLinesBy"),{}),[r,t]),f=(0,o.useMemo)(()=>{let e=[];return"about"===s?d.length>0?Object.entries(g).forEach(t=>{let[r,n]=t;d.some(e=>!!n[e]&&(Array.isArray(n[e])?n[e].length>0:"object"==typeof n[e]&&Object.values(n[e]).some(e=>Array.isArray(e)&&e.length>0)))&&e.push(r)}):e=Object.keys(g):d.length>0?Object.entries(x).forEach(t=>{let[r,n]=t;d.some(e=>!!n[e]&&(Array.isArray(n[e])?n[e].length>0:"object"==typeof n[e]&&Object.values(n[e]).some(e=>Array.isArray(e)&&e.length>0)))&&e.push(r)}):e=Object.keys(x),e.sort()},[s,g,x,d]),b=(0,o.useMemo)(()=>{let e;let t=new Set;return Object.entries("about"===s?g:x).forEach(e=>{let[r,n]=e;(0===a.length||a.includes(r))&&Object.entries(n).forEach(e=>{let[r,n]=e;Array.isArray(n)&&n.length>0?t.add(r):"object"==typeof n&&null!==n&&Object.values(n).some(e=>Array.isArray(e)&&e.length>0)&&t.add(r)})}),Array.from(t).sort()},[s,g,x,a]),v=e=>{u(t=>{let r;return(r=t.includes(e)?t.filter(t=>t!==e):[...t,e]).length>0?sessionStorage.setItem("voiceLineFilterCategories",JSON.stringify(r)):sessionStorage.removeItem("voiceLineFilterCategories"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("voiceLineFilterChange"))},0),r})};return(0,o.useEffect)(()=>{{let e=sessionStorage.getItem("voiceLineFilterTab");e&&l(e),sessionStorage.removeItem("voiceLineFilterCharacters"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("voiceLineFilterChange"))},0);let t=sessionStorage.getItem("voiceLineFilterCategories");if(t)try{let e=JSON.parse(t);Array.isArray(e)&&u(e)}catch(e){console.error("Error parsing saved voice line filter categories:",e)}}},[]),(0,o.useEffect)(()=>{console.log("VoiceLinesFilter component mounted"),console.log("Initial voiceLines data:",r?Object.keys(r).length:"null"),console.log("Initial characterName:",t)},[]),(0,o.useEffect)(()=>{{let e=e=>{let t=e.detail;console.log("VoiceLinesFilter - Custom event received:",t),t&&t!==s&&(l(t),c([]),u([]))};return window.addEventListener("voiceLineTabChange",e),()=>{window.removeEventListener("voiceLineTabChange",e)}}},[s]),(0,n.jsxs)("div",{children:[(0,n.jsx)(j.A,{characters:f,selectedCharacters:a,onChange:e=>{console.log("VoiceLinesFilter - Character filter changed:",e),c(e),e.length>0?sessionStorage.setItem("voiceLineFilterCharacters",JSON.stringify(e)):sessionStorage.removeItem("voiceLineFilterCharacters"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("voiceLineFilterChange"))},0)},title:"Filter by Characters"}),d.length>0&&(0,n.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsxs)("div",{className:"text-sm text-gray-400",children:["Selected: ",d.length," ",1===d.length?"category":"categories"]}),(0,n.jsx)("button",{onClick:()=>{u([]),sessionStorage.removeItem("voiceLineFilterCategories"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("voiceLineFilterChange"))},0)},className:"px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700",children:"Clear Selection"})]}),(0,n.jsx)("div",{className:"flex flex-wrap gap-1",children:d.map(e=>(0,n.jsxs)("div",{className:"bg-blue-800 text-xs text-white px-2 py-1 rounded-full flex items-center",children:[(0,n.jsx)("span",{children:e}),(0,n.jsx)("button",{className:"ml-1 text-blue-300 hover:text-white",onClick:()=>v(e),children:(0,n.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]},e))})]}),(0,n.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>m(!h),children:[(0,n.jsx)("h3",{className:"text-white font-medium",children:"Filter by Categories"}),(0,n.jsx)("svg",{className:"w-5 h-5 text-gray-400 transform ".concat(h?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),h&&(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)("div",{className:"max-h-80 overflow-y-auto pr-2 space-y-2 custom-scrollbar",children:b.map(e=>(0,n.jsxs)("div",{className:"flex items-center p-2.5 rounded cursor-pointer ".concat(d.includes(e)?"bg-blue-900 hover:bg-blue-800":"hover:bg-gray-700"),onClick:()=>v(e),children:[(0,n.jsx)("span",{className:"text-sm text-white flex-1 truncate",children:e}),d.includes(e)&&(0,n.jsx)("svg",{className:"w-5 h-5 ml-2 text-blue-400 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},e))})})]})]})},N="\n  .custom-scrollbar::-webkit-scrollbar {\n    width: 12px;\n  }\n  \n  .custom-scrollbar::-webkit-scrollbar-track {\n    background: #2d3748;\n    border-radius: 6px;\n    margin: 2px;\n  }\n  \n  .custom-scrollbar::-webkit-scrollbar-thumb {\n    background: #4a5568;\n    border-radius: 6px;\n    border: 2px solid #2d3748;\n    min-height: 40px;\n  }\n  \n  .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n    background: #718096;\n  }\n  \n  /* For Firefox */\n  .custom-scrollbar {\n    scrollbar-width: thin;\n    scrollbar-color: #4a5568 #2d3748;\n    touch-action: pan-y;\n    -webkit-overflow-scrolling: touch;\n  }\n  \n  /* For mobile - larger touch area */\n  @media (pointer: coarse) {\n    .custom-scrollbar::-webkit-scrollbar {\n      width: 16px;\n    }\n    \n    .custom-scrollbar::-webkit-scrollbar-thumb {\n      min-height: 48px;\n    }\n  }\n",S="previousPath",k="selectedPartners",E="filtersCleared";function L(e){let{character:t,conversations:r}=e,[s,d]=(0,o.useState)(!0),[g,x]=(0,o.useState)([]),[b,L]=(0,o.useState)(0===r.length?"voicelines":"conversations"),[C,O]=(0,o.useState)([]),A=(0,p.usePathname)(),V=(0,p.useRouter)(),{voiceLines:I,data:P}=(0,c.E)(),F=I?(0,i.N3)(I,t.name):0,_=I?(0,i.Fc)(I,t.name):0;(0,o.useEffect)(()=>{{console.log("CharacterPageClient - voiceLines data:",I?"available":"not available"),I&&console.log("CharacterPageClient - voiceLines keys:",Object.keys(I));let e=()=>{sessionStorage.setItem(S,A)};if(window.addEventListener("beforeunload",e),"true"===sessionStorage.getItem(E))sessionStorage.removeItem(E);else{let e=sessionStorage.getItem(k);if(e)try{let r=JSON.parse(e);if(Array.isArray(r)){let e=r.filter(e=>t.conversationPartners.includes(e));x(e)}}catch(e){console.error("Error parsing selected partners:",e)}}return()=>{window.removeEventListener("beforeunload",e)}}},[A,t.conversationPartners,I]),(0,o.useEffect)(()=>{g.length>0?sessionStorage.setItem(k,JSON.stringify(g)):sessionStorage.removeItem(k)},[g]),(0,o.useEffect)(()=>{if(P&&P.conversations){let e=new Set;P.conversations.forEach(t=>{e.add(t.character1),e.add(t.character2)}),O(Array.from(e))}},[P]);let J=(0,u.v)(t.name);r.filter(e=>{if(!s&&!e.is_complete)return!1;if(g.length>0){let r=e.character1===t.name?e.character2:e.character1;return g.includes(r)}return!0});let M=e=>{let t=(0,m.h)(e);return"/minimapIcons/".concat(t,"_mm_psd.png")},R=e=>{x(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},z=e=>{sessionStorage.setItem(S,A),g.length>0?sessionStorage.setItem(k,JSON.stringify(g)):sessionStorage.removeItem(k),window.location.href="/conversations/".concat(encodeURIComponent(e))},T=(0,o.useMemo)(()=>{let e=[...r];return g.length>0&&(e=e.filter(e=>{let r=e.character1===t.name?e.character2:e.character1;return g.includes(r)})),s||(e=e.filter(e=>e.is_complete)),e.sort((e,t)=>e.conversation_id.localeCompare(t.conversation_id))},[r,g,s,t.name]);return(0,n.jsxs)("div",{children:[(0,n.jsx)(l(),{id:N.__hash,children:N}),(0,n.jsx)("div",{className:"mb-6",children:(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsxs)(v(),{href:"/",className:"inline-flex items-center text-blue-400 hover:underline",onClick:()=>{sessionStorage.setItem(S,"/"),sessionStorage.removeItem(k),sessionStorage.setItem(E,"true")},children:[(0,n.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 mr-1",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Home"]}),(0,n.jsxs)("button",{onClick:()=>{let e="conversations"===b?"/conversations":"/voicelines";sessionStorage.setItem(S,e),sessionStorage.removeItem(k),sessionStorage.setItem(E,"true"),V.push(e)},className:"inline-flex items-center text-blue-400 hover:underline bg-transparent border-none cursor-pointer",children:[(0,n.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 mr-1",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"conversations"===b?"Go to Conversations Search":"Go to Voice Lines Search"]})]})}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-6 mb-8",children:[(0,n.jsx)("div",{className:"w-full md:w-1/3 lg:w-1/4 xl:w-1/5 md:min-w-[300px] md:h-screen md:sticky md:top-0 md:self-start",children:(0,n.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 sm:p-6 overflow-y-auto h-auto md:max-h-[calc(100vh-2rem)] md:my-4 custom-scrollbar",children:[(0,n.jsx)("div",{className:"relative w-24 sm:w-32 h-24 sm:h-32 mx-auto mb-4",children:(0,n.jsx)(h.default,{src:M(t.name),alt:"".concat(J," portrait"),fill:!0,sizes:"(max-width: 640px) 96px, 128px",className:"object-cover rounded-full",onError:e=>{e.target.src="/minimapIcons/genericperson_mm_psd.png"}})}),(0,n.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-white text-center mb-4",children:J}),"voicelines"===b&&(0,n.jsxs)("div",{className:"bg-gray-700 rounded-lg p-3 mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:"Voice Line Stats"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-center",children:[(0,n.jsxs)("div",{className:"bg-gray-800 rounded p-2",children:[(0,n.jsx)("div",{className:"text-xl font-bold text-blue-400",children:F}),(0,n.jsxs)("div",{className:"text-xs text-gray-400",children:["By ",J]})]}),(0,n.jsxs)("div",{className:"bg-gray-800 rounded p-2",children:[(0,n.jsx)("div",{className:"text-xl font-bold text-blue-400",children:_}),(0,n.jsxs)("div",{className:"text-xs text-gray-400",children:["About ",J]})]})]})]}),(0,n.jsxs)("div",{className:"mt-6",children:[(0,n.jsxs)("div",{className:"flex border-b border-gray-700 mb-4",children:[(0,n.jsx)("button",{onClick:()=>L("conversations"),className:"px-4 py-2 font-medium ".concat("conversations"===b?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"),children:"Conversations"}),(0,n.jsx)("button",{onClick:()=>L("voicelines"),className:"px-4 py-2 font-medium ".concat("voicelines"===b?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"),children:"Voice Lines"})]}),"conversations"===b&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.A,{characters:t.conversationPartners,selectedCharacters:g,onChange:e=>{x(e)},title:"Filter by Partners"}),(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsxs)("label",{className:"flex items-center text-white cursor-pointer",children:[(0,n.jsx)("input",{type:"checkbox",checked:s,onChange:()=>d(!s),className:"mr-2 h-4 w-4"}),"Show Incomplete Conversations"]})}),(0,n.jsx)("div",{className:"mt-4 pb-4",children:(0,n.jsx)("button",{onClick:()=>{(0,y.B2)(t.name,r),window.location.reload()},className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Reset Viewed Conversations"})})]}),"voicelines"===b&&(0,n.jsx)(n.Fragment,{children:I?(0,n.jsx)(w,{characterName:t.name,voiceLines:I}):(0,n.jsx)("div",{className:"bg-gray-700 rounded-lg p-4 text-center text-gray-300",children:"Voice line data is loading or unavailable"})})]})]})}),(0,n.jsx)("div",{className:"w-full md:flex-1",children:"conversations"===b?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("h2",{className:"text-xl font-bold text-white mb-4",children:[g.length>0?"Conversations with ".concat(1===g.length?(0,u.v)(g[0]):"".concat(g.length," characters")):"All Conversations",(0,n.jsxs)("span",{className:"ml-2 text-sm font-normal text-gray-400",children:["(",T.length," ",1===T.length?"conversation":"conversations",")"]})]}),g.length>1&&(0,n.jsxs)("div",{className:"mb-4 flex flex-wrap gap-2 items-center",children:[(0,n.jsx)("span",{className:"text-gray-300",children:"Filtered by:"}),g.map(e=>(0,n.jsxs)("span",{className:"px-3 py-1 bg-blue-800 text-white rounded-full text-sm flex items-center",children:[(0,n.jsx)("div",{className:"relative w-4 h-4 mr-1",children:(0,n.jsx)(h.default,{src:M(e),alt:"".concat((0,u.v)(e)," portrait"),fill:!0,sizes:"16px",className:"object-cover rounded-full",onError:e=>{e.target.src="/minimapIcons/genericperson_mm_psd.png"}})}),(0,u.v)(e),(0,n.jsx)("button",{onClick:()=>R(e),className:"ml-2 text-white hover:text-gray-200",children:(0,n.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]},e))]}),T.length>0?(0,n.jsx)("div",{className:"grid grid-cols-1 gap-4 overflow-y-auto max-h-[calc(100vh-200px)] custom-scrollbar pr-2",children:T.map(e=>(0,n.jsx)(a.A,{conversation:e,highlightCharacter:t.name,onClick:()=>z(e.conversation_id)},e.conversation_id))}):(0,n.jsx)("div",{className:"text-center py-8 bg-gray-800 rounded-lg",children:(0,n.jsx)("p",{className:"text-gray-400",children:"No conversations found matching your criteria."})})]}):(0,n.jsx)(f,{characterName:t.name})})]})]})}},9232:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(5155),s=r(2115),l=r(5565),o=r(4957),a=r(71),c=r(3116);let i=e=>{let{conversation:t,highlightCharacter:r,onClick:i}=e,{conversation_id:d,character1:u,character2:h,is_complete:m,missing_parts:g,summary:x,lines:f}=t,[b,v]=(0,s.useState)(!1);(0,s.useEffect)(()=>{v((0,c.yV)(d))},[d]);let p=r?u===r?h:u:null,y=(0,o.v)(u),j=(0,o.v)(h),w=p?(0,o.v)(p):null,N=p?"Conversation with ".concat(w):"".concat(y," & ").concat(j),S=x||(f.length>0?f[0].transcription:"No preview available"),k=e=>{let t=(0,a.h)(e);return"/minimapIcons/".concat(t,"_mm_psd.png")};return(0,n.jsx)("div",{className:"\n        bg-gray-800 rounded-lg overflow-hidden shadow-lg hover:shadow-xl transition-shadow duration-300 p-4 mb-4 \n        ".concat(m?"":"border-l-4 border-yellow-600"," \n        ").concat(b?"opacity-70 bg-gray-900":""," \n        ").concat(i?"cursor-pointer hover:bg-gray-750":"","\n      "),onClick:i,role:i?"button":void 0,tabIndex:i?0:void 0,onKeyDown:e=>{i&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),i())},children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("div",{className:"flex-shrink-0 mr-4",children:r&&p?(0,n.jsx)("div",{className:"relative w-12 h-12",children:(0,n.jsx)(l.default,{src:k(p),alt:"".concat(w," portrait"),fill:!0,sizes:"48px",className:"object-cover rounded-full ".concat(b?"opacity-70":""),onError:e=>{e.target.src="/minimapIcons/genericperson_mm_psd.png"}})}):(0,n.jsxs)("div",{className:"flex -space-x-3",children:[(0,n.jsx)("div",{className:"relative w-12 h-12 z-10",children:(0,n.jsx)(l.default,{src:k(u),alt:"".concat(y," portrait"),fill:!0,sizes:"48px",className:"object-cover rounded-full border-2 border-gray-800 ".concat(b?"opacity-70":""),onError:e=>{e.target.src="/minimapIcons/genericperson_mm_psd.png"}})}),(0,n.jsx)("div",{className:"relative w-12 h-12 z-0",children:(0,n.jsx)(l.default,{src:k(h),alt:"".concat(j," portrait"),fill:!0,sizes:"48px",className:"object-cover rounded-full border-2 border-gray-800 ".concat(b?"opacity-70":""),onError:e=>{e.target.src="/minimapIcons/genericperson_mm_psd.png"}})})]})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white",children:N}),(0,n.jsx)("p",{className:"text-gray-400 text-sm mt-1 line-clamp-3",children:S}),(0,n.jsxs)("div",{className:"flex items-center mt-2",children:[!m&&(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-800 text-yellow-100 mr-2",children:"Incomplete"}),g.length>0&&(0,n.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-800 text-red-100",children:["Missing parts: ",g.join(", ")]}),b&&(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-800 text-blue-100 ml-auto",children:"Viewed"})]})]})]})})}}}]);