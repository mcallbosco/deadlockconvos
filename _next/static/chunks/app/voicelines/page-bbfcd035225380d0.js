(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[870],{3646:(e,t,s)=>{"use strict";s.d(t,{default:()=>m});var r=s(5155),l=s(2115),n=s(9895),a=s(4874),c=s(4957),i=s(71),o=s(5565),d=s(8173),u=s.n(d),h=s(2030);let x=e=>{let{options:t,selectedOptions:s,onChange:n,title:a,getDisplayName:c=e=>e}=e,[i,o]=(0,l.useState)(""),[d,u]=(0,l.useState)(!0),h=t.filter(e=>c(e).toLowerCase().includes(i.toLowerCase())),x=e=>{s.includes(e)?n(s.filter(t=>t!==e)):n([...s,e])};return(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center cursor-pointer mb-2",onClick:()=>u(!d),children:[(0,r.jsx)("h3",{className:"text-white font-medium",children:a}),(0,r.jsx)("svg",{className:"w-5 h-5 text-gray-400 transform ".concat(d?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),d&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-3",children:(0,r.jsx)("input",{type:"text",value:i,onChange:e=>o(e.target.value),placeholder:"Search ".concat(a.toLowerCase(),"..."),className:"w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-1 focus:ring-blue-500 text-sm"})}),(0,r.jsx)("div",{className:"flex justify-between mb-3",children:s.length>0&&(0,r.jsx)("button",{onClick:()=>{n([])},className:"px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700",children:"Clear Selection"})}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto pr-1 space-y-1",children:h.length>0?h.map(e=>(0,r.jsxs)("div",{className:"flex items-center p-2 rounded cursor-pointer ".concat(s.includes(e)?"bg-blue-900 hover:bg-blue-800":"hover:bg-gray-700"),onClick:()=>x(e),children:[(0,r.jsx)("span",{className:"text-sm text-white",children:c(e)}),s.includes(e)&&(0,r.jsx)("svg",{className:"w-4 h-4 ml-auto text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},e)):(0,r.jsx)("div",{className:"text-center py-4 text-gray-400",children:"No options found"})}),s.length>0&&(0,r.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-700",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-400 mb-2",children:["Selected: ",s.length," ",1!==s.length?a.toLowerCase().replace("filter by ",""):a.toLowerCase().replace("filter by ","").slice(0,-1)]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:s.map(e=>(0,r.jsxs)("div",{className:"bg-blue-800 text-xs text-white px-2 py-1 rounded-full flex items-center",children:[(0,r.jsx)("span",{children:c(e)}),(0,r.jsx)("button",{className:"ml-1 text-blue-300 hover:text-white",onClick:t=>{t.stopPropagation(),x(e)},children:(0,r.jsx)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]},e))})]})]})]})};function m(){let{voiceLines:e,loading:t,error:s}=(0,n.E)(),[d,m]=(0,l.useState)(""),[g,p]=(0,l.useState)(null),[f,b]=(0,l.useState)(null),[j,v]=(0,l.useState)(null),[y,w]=(0,l.useState)([]),[N,k]=(0,l.useState)([]),[C,L]=(0,l.useState)([]),[E,S]=(0,l.useState)(""),[M,O]=(0,l.useState)(null),[B,F]=(0,l.useState)(null),[_,R]=(0,l.useState)(null),[P,A]=(0,l.useState)([]),[V,z]=(0,l.useState)([]),[H,W]=(0,l.useState)([]),[I,T]=(0,l.useState)(!1),[D,q]=(0,l.useState)(1),[G,J]=(0,l.useState)(!1),K=(0,l.useRef)(null),Q=(0,l.useRef)(0),U=(0,l.useRef)([]),[X,Y]=(0,l.useState)(null),Z=(0,l.useMemo)(()=>{if(!e)return[];let t=new Set;return Object.keys(e).forEach(e=>{t.add(e)}),Array.from(t).sort((e,t)=>(0,c.v)(e).localeCompare((0,c.v)(t)))},[e]);(0,l.useMemo)(()=>{if(!e)return[];let t=[];return Object.entries(e).forEach(e=>{let[s,r]=e;Object.entries(r).forEach(e=>{let[r,l]=e;Object.entries(l).forEach(e=>{let[l,n]=e;Array.isArray(n)?n.forEach(e=>{t.push({...e,speaker:s,target:r,category:l})}):Object.entries(n).forEach(e=>{let[n,a]=e;a.forEach(e=>{t.push({...e,speaker:s,target:r,category:"".concat(l," - ").concat(n)})})})})})}),t},[e]);let $=(0,l.useCallback)(()=>{T(!0),setTimeout(()=>{S(d),O(g),F(f),R(j),A(y),z(N),W(C),q(1),T(!1)},300)},[d,g,f,j,y,N,C]),ee=(0,l.useCallback)(()=>{m(""),p(null),b(null),v(null),w([]),k([]),L([]),q(1),S(""),O(null),F(null),R(null),A([]),z([]),W([]),T(!0),setTimeout(()=>{T(!1)},300)},[]),et=e=>{q(e)};(0,l.useEffect)(()=>{Z.length>0&&!I&&$()},[Z,$,I]);let es=(0,l.useMemo)(()=>{if(!e)return[];let t=new Set,s=y.length>0?y:g?[g]:[];return(0===s.length?Object.keys(e):s).forEach(s=>{e[s]&&Object.keys(e[s]).forEach(e=>{t.add(e)})}),Array.from(t).sort((e,t)=>(0,c.v)(e).localeCompare((0,c.v)(t)))},[e,g,y]),er=(0,l.useMemo)(()=>{if(!e)return[];let t=new Set,s=y.length>0?y:g?[g]:[];return(0===s.length?Object.keys(e):s).forEach(s=>{e[s]&&(N.length>0?N:j?[j]:Object.keys(e[s])).forEach(r=>{e[s][r]&&Object.keys(e[s][r]).forEach(l=>{"Pings"===l?Object.keys(e[s][r][l]).forEach(e=>{t.add("".concat(l," - ").concat(e))}):t.add(l)})})}),Array.from(t).sort()},[e,g,j,N,y]),el=(0,l.useMemo)(()=>{if(I||!e)return[];let t=[];return(P.length>0?P:M?[M]:Object.keys(e)).forEach(s=>{e[s]&&Object.entries(e[s]).forEach(e=>{let[r,l]=e;Object.entries(l).forEach(e=>{let[l,n]=e;"Pings"===l?Object.entries(n).forEach(e=>{let[n,a]=e;a.forEach(e=>{t.push({...e,speaker:s,target:r,category:"".concat(l," - ").concat(n),voiceline_id:"".concat(s,"-").concat(r,"-").concat(e.filename)})})}):n.forEach(e=>{t.push({...e,speaker:s,target:r,category:l,voiceline_id:"".concat(s,"-").concat(r,"-").concat(e.filename)})})})})}),t.filter(e=>{if(V.length>0&&!V.some(t=>e.target.toLowerCase()===t.toLowerCase())||_&&e.target.toLowerCase()!==_.toLowerCase()||H.length>0&&!H.some(t=>e.category&&e.category.includes(t))||B&&(!e.category||!e.category.includes(B)))return!1;if(E){let t=E.toLowerCase().split(",").map(e=>e.trim()),s=e.transcription.toLowerCase();return t.some(e=>e&&s.includes(e))}return!0})},[I,e,M,_,B,E,P,V,H]),en=Math.ceil(el.length/100),ea=(0,l.useMemo)(()=>{let e=(D-1)*100;return el.slice(e,e+100)},[el,D]);(0,l.useEffect)(()=>{q(1)},[E,M,B,_,V,H]),(0,l.useEffect)(()=>{(null!==g||y.length>0)&&(b(null),L([]))},[g,y]),(0,l.useEffect)(()=>{(null!==g||y.length>0)&&(v(null),k([]))},[g,y]);let ec=e=>{let t=(0,i.h)(e);return"/minimapIcons/".concat(t,"_mm_psd.png")},ei=()=>{if(Q.current++,Q.current<U.current.length){let e=U.current[Q.current];Y(e),K.current&&(K.current.src="/audioFiles/".concat(e),K.current.play().catch(e=>{console.error("Error playing next audio:",e),J(!1),Y(null)}))}else J(!1),Y(null)},eo=e=>{G&&(K.current&&(K.current.pause(),K.current.removeEventListener("ended",ei),K.current=null),J(!1)),Y(e)},ed=e=>{X===e&&Y(null)};return t?(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Voice Lines"}),(0,r.jsxs)(u(),{href:"/",className:"text-blue-400 hover:underline flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Home"]})]}),(0,r.jsxs)("div",{className:"text-center py-16",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"}),(0,r.jsx)("p",{className:"text-xl text-gray-300",children:"Loading voice lines data..."})]})]}):s?(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Voice Lines"}),(0,r.jsxs)(u(),{href:"/",className:"text-blue-400 hover:underline flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Home"]})]}),(0,r.jsxs)("div",{className:"bg-red-900 text-white p-6 rounded-lg",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Error Loading Data"}),(0,r.jsx)("p",{className:"text-red-200",children:s})]})]}):e?(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Voice Lines"}),(0,r.jsxs)(u(),{href:"/",className:"text-blue-400 hover:underline flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Home"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Filters"}),(0,r.jsx)(h.A,{characters:Z,selectedCharacters:y,onChange:w,title:"Filter by Speakers"}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[(0,r.jsx)("div",{className:"flex justify-between items-center cursor-pointer mb-2",children:(0,r.jsx)("h3",{className:"text-white font-medium",children:"Search Transcriptions"})}),(0,r.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"Search terms (separate with commas)...",className:"w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-1 focus:ring-blue-500"}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Separate multiple search terms with commas"})]}),(0,r.jsx)(x,{options:es,selectedOptions:N,onChange:k,title:"Filter by Target",getDisplayName:c.v}),(0,r.jsx)(x,{options:er,selectedOptions:C,onChange:L,title:"Filter by Category"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:ee,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Clear Filters"}),(0,r.jsx)("button",{onClick:$,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Search"})]})]})}),(0,r.jsx)("div",{className:"lg:col-span-3",children:(0,r.jsx)("div",{id:"results-top",className:"space-y-4",children:I?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500 mb-2"}),(0,r.jsx)("p",{className:"text-gray-300",children:"Searching..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4",children:[(0,r.jsxs)("div",{className:"text-gray-300 mb-2 md:mb-0",children:["Found ",el.length," voice lines",(E||P.length>0||B||_||V.length>0||H.length>0)&&(0,r.jsxs)("span",{className:"ml-2 text-gray-400",children:["(Filtered",E?' by "'.concat(E.replace(/,/g,'", "'),'"'):"",P.length>0?" from ".concat(P.length," character").concat(1!==P.length?"s":""):"",_?" to ".concat((0,c.v)(_)):"",V.length>0?" to ".concat(V.length," target").concat(1!==V.length?"s":""):"",B?" in ".concat(B):"",H.length>0?" in ".concat(H.length," categor").concat(1!==H.length?"ies":"y"):"",")"]})]}),el.length>0&&(0,r.jsx)("button",{onClick:()=>{if(G){K.current&&(K.current.pause(),K.current.removeEventListener("ended",ei),K.current=null),J(!1),Y(null);return}let e=el.map(e=>e.filename);0!==e.length&&(U.current=e,Q.current=0,J(!0),Y(e[0]),K.current||(K.current=new Audio,K.current.addEventListener("ended",ei)),K.current.src="/audioFiles/".concat(e[0]),K.current.play().catch(e=>{console.error("Error playing audio:",e),J(!1),Y(null)}))},className:"px-4 py-2 rounded-lg text-white font-medium ".concat(G?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"),children:(0,r.jsx)("div",{className:"flex items-center",children:G?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M6 4h2v12H6V4zm6 0h2v12h-2V4z",clipRule:"evenodd"})}),"Stop Playing"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M8 4l8 6-8 6V4z",clipRule:"evenodd"})}),"Play All Voice Lines"]})})}),en>1&&(0,r.jsxs)("div",{className:"text-sm text-gray-400 mt-2 md:mt-0",children:["Page ",D," of ",en]})]}),ea.map((e,t)=>(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"relative w-8 h-8 mr-2",children:(0,r.jsx)(o.default,{src:ec(e.speaker),alt:"".concat((0,c.v)(e.speaker)," portrait"),fill:!0,sizes:"32px",className:"object-cover rounded-full",onError:e=>{e.target.src="/minimapIcons/genericperson_mm_psd.png"}})}),(0,r.jsx)("span",{className:"text-white font-medium",children:(0,c.v)(e.speaker)})]}),"self"!==e.target.toLowerCase()&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex items-center mx-2",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-400 mx-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14 5l7 7m0 0l-7 7m7-7H3"})})}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"relative w-8 h-8 mr-2",children:(0,r.jsx)(o.default,{src:ec(e.target),alt:"".concat((0,c.v)(e.target)," portrait"),fill:!0,sizes:"32px",className:"object-cover rounded-full",onError:e=>{e.target.src="/minimapIcons/genericperson_mm_psd.png"}})}),(0,r.jsx)("span",{className:"text-white font-medium",children:(0,c.v)(e.target)})]})]}),e.category&&(0,r.jsx)("span",{className:"text-gray-400 text-sm ml-4",children:e.category})]}),(0,r.jsx)(a.A,{filename:e.filename,transcription:e.transcription,externalIsPlaying:X===e.filename,onPlay:eo,onPause:ed})]},"".concat(e.filename,"-").concat(t))),0===el.length&&(0,r.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No voice lines found matching your criteria"}),(()=>{if(en<=1)return null;let e=[];e.push((0,r.jsx)("button",{onClick:()=>et(1),className:"px-3 py-1 rounded ".concat(1===D?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"1"},"first"));let t=Math.max(2,D-Math.floor(3.5)),s=Math.min(en-1,t+7-3);t>2&&e.push((0,r.jsx)("span",{className:"px-2 text-gray-400",children:"..."},"ellipsis1"));for(let l=t;l<=s;l++)e.push((0,r.jsx)("button",{onClick:()=>et(l),className:"px-3 py-1 rounded ".concat(D===l?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:l},l));return s<en-1&&e.push((0,r.jsx)("span",{className:"px-2 text-gray-400",children:"..."},"ellipsis2")),en>1&&e.push((0,r.jsx)("button",{onClick:()=>et(en),className:"px-3 py-1 rounded ".concat(D===en?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:en},"last")),(0,r.jsxs)("div",{className:"flex justify-center space-x-2 mt-6",children:[(0,r.jsx)("button",{onClick:()=>et(Math.max(1,D-1)),disabled:1===D,className:"px-3 py-1 rounded ".concat(1===D?"bg-gray-800 text-gray-500 cursor-not-allowed":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"<"}),e,(0,r.jsx)("button",{onClick:()=>et(Math.min(en,D+1)),disabled:D===en,className:"px-3 py-1 rounded ".concat(D===en?"bg-gray-800 text-gray-500 cursor-not-allowed":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:">"})]})})()]})})})]})]}):(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Voice Lines"}),(0,r.jsxs)(u(),{href:"/",className:"text-blue-400 hover:underline flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),"Back to Home"]})]}),(0,r.jsx)("div",{className:"text-center py-16 bg-gray-800 rounded-lg",children:(0,r.jsx)("p",{className:"text-xl text-gray-300",children:"No voice lines available."})})]})}},7412:(e,t,s)=>{Promise.resolve().then(s.bind(s,3646))}},e=>{var t=t=>e(e.s=t);e.O(0,[565,895,129,441,587,358],()=>t(7412)),_N_E=e.O()}]);